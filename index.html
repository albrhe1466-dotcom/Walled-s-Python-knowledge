<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø§Ù…ØªØ­Ø§Ù† ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆÙ„ÙŠØ¯</title>
  <style>
    :root {
      --bg: #0b1220;
      --card: #111a2b;
      --accent: #30d158;   /* glowing green */
      --accent-2: #4db3ff;
      --text: #eaf2ff;
      --muted: #9fb0c6;
      --danger: #ff6b6b;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: radial-gradient(1200px 600px at 70% 20%, #12203a, var(--bg));
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Moving faded background lines */
    .line {
      position: fixed;
      top: 0;
      height: 120vh;
      width: 2px;
      background: rgba(48, 209, 88, 0.06);
      box-shadow: 0 0 10px rgba(48, 209, 88, 0.08);
      animation: moveLine 6s linear infinite;
      z-index: 0;
      pointer-events: none;
    }
    @keyframes moveLine {
      from { transform: translateY(-120%); }
      to   { transform: translateY(100%); }
    }

    /* Floating PyCharm code bits */
    .float-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }
    .code-bit {
      position: absolute;
      color: #b8e1ff;
      font-family: Consolas, "Courier New", monospace;
      font-size: 14px;
      opacity: 0.18;
      white-space: nowrap;
      filter: blur(0.3px);
      animation: drift linear infinite;
    }
    @keyframes drift {
      from { transform: translate3d(var(--x-start), var(--y-start), 0) rotate(var(--rot)); }
      to   { transform: translate3d(var(--x-end), var(--y-end), 0) rotate(calc(var(--rot) + 20deg)); }
    }

    header {
      position: relative;
      z-index: 1;
      padding: 28px 20px 8px;
      text-align: center;
      animation: fadeInDown 1.2s ease;
    }
    header h1 {
      margin: 0 0 6px;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: var(--accent);
      text-shadow: 0 0 12px var(--accent);
    }
    header p {
      margin: 0;
      color: var(--muted);
      animation: fadeIn 1.6s ease;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 960px;
      margin: 20px auto 80px;
      padding: 0 16px;
    }

    .card {
      background: linear-gradient(180deg, #13233d 0%, var(--card) 100%);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,0.35);
      padding: 18px;
      animation: fadeInUp 1.1s ease;
    }

    .steps {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 6px;
      margin-bottom: 12px;
    }
    .step-dot {
      height: 8px;
      border-radius: 999px;
      background: #2a3a56;
      position: relative;
      overflow: hidden;
      animation: pulse 3s infinite;
    }
    .step-dot.active { background: var(--accent); }
    .step-dot.done { background: #67e685; }
    .step-dot::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, rgba(255,255,255,0.12), rgba(255,255,255,0));
    }

    h2 {
      margin: 8px 0 12px;
      font-size: 22px;
      color: var(--accent);
      text-shadow: 0 0 8px var(--accent);
    }
    .muted {
      color: var(--muted);
      font-size: 14px;
    }

    .question {
      margin-top: 8px;
      background: rgba(255,255,255,0.04);
      border: 1px dashed rgba(255,255,255,0.10);
      border-radius: 10px;
      padding: 14px;
      animation: pulse 2s infinite;
    }
    .options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    .btn {
      border: none;
      border-radius: 10px;
      padding: 12px 14px;
      background: #1a2a45;
      color: var(--text);
      cursor: pointer;
      transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
    }
    .btn:hover { transform: scale(1.05); background: #20345a; box-shadow: 0 0 15px var(--accent-2); }
    .btn:active { transform: scale(0.98); }

    .btn-primary {
      background: var(--accent);
      color: #041a0a;
      font-weight: 600;
      box-shadow: 0 0 12px var(--accent);
    }

    .controls {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .controls .spacer { flex: 1; }

    .input {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.12);
      background: #0f1a2b;
      color: var(--text);
      font-size: 16px;
      direction: rtl;
    }

    .handwrite {
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 10px;
      background: #0f1a2b;
      height: 220px;
      position: relative;
      overflow: hidden;
      cursor: crosshair;
    }
    .handwrite canvas { width: 100%; height: 100%; display: block; }

    .result {
      display: none;
      margin-top: 14px;
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 10px;
      padding: 12px;
      animation: fadeIn 1.5s ease;
    }

    footer {
      text-align: center;
      color: var(--muted);
      padding: 30px 16px 40px;
    }

    .pill {
      display: inline-block;
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: 999px;
      padding: 6px 10px;
      background: rgba(255,255,255,0.04);
      font-size: 12px;
      margin: 2px 4px;
    }

    /* Animations */
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to   { opacity: 1; }
    }
    @keyframes pulse {
      0%   { box-shadow: 0 0 6px var(--accent-2); }
      50%  { box-shadow: 0 0 18px var(--accent-2); }
      100% { box-shadow: 0 0 6px var(--accent-2); }
    }

    /* Confetti */
    .confetti {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
      z-index: 999;
    }
    .confetti-piece {
      position: absolute;
      width: 10px;
      height: 20px;
      background: var(--accent);
      opacity: 0.85;
      animation: fall 3.2s linear infinite;
    }
    @keyframes fall {
      to { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
  </style>
</head>
<body>
  <!-- Moving lines -->
  <div id="lines"></div>

  <!-- Floating PyCharm code, faster drift -->
  <div class="float-layer" id="floatLayer" aria-hidden="true"></div>

  <header>
    <h1>Ø§Ù…ØªØ­Ø§Ù† ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆÙ„ÙŠØ¯</h1>
    <p>Ø§Ø®ØªØ¨Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠ Ù…ÙƒÙˆÙ‘Ù† Ù…Ù† 12 Ø®Ø·ÙˆØ© Ù…Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© ÙˆØ­Ø±ÙƒØ© Ø®Ù„ÙÙŠØ© Ù†Ø§Ø¹Ù…Ø©.</p>
  </header>

  <div class="container">
    <div class="card">
      <div class="steps" id="steps"></div>

      <h2 id="stepTitle">Ù‡Ù„ Ø£Ù†Øª Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø¯Ø¡ØŸ</h2>
      <p class="muted" id="stepDesc">
        Ù‚ØµØ§ØµØ§Øª ÙƒÙˆØ¯ PyCharm ØªØªØ­Ø±Ùƒ Ø­ÙˆÙ„Ùƒ Ø¨Ø®ÙØ©. Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ø§Ù„Ø£Ø®Ø¶Ø± Ù„Ø´Ø±Ø­ Ø³Ø±ÙŠØ¹ØŒ Ø«Ù… Ø§Ø¨Ø¯Ø£.
      </p>

      <div class="question" id="questionBox"></div>
      <div class="controls">
        <button class="btn btn-secondary" id="btnTutorial">Ø´Ø±Ø­ Ù‚ØµÙŠØ±</button>
        <div class="spacer"></div>
        <button class="btn" id="btnBack">Ø±Ø¬ÙˆØ¹</button>
        <button class="btn btn-primary" id="btnNext">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      </div>

      <div class="result" id="resultBox"></div>
    </div>

    <footer>
      <span class="pill">Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©: Ø£Ø³Ø¦Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© ÙƒÙ„ ØªØ´ØºÙŠÙ„</span>
      <span class="pill">Ø§Ù„ÙƒØªØ§Ø¨Ø©: Ø®Ø·ÙˆØ§Øª 4 Ùˆ7 Ùˆ11</span>
      <span class="pill">Ø§Ù„Ù‡Ø¯ÙˆØ¡: Ø­Ø±ÙƒØ§Øª Ø®Ù„ÙÙŠØ© Ø¨Ø¯ÙˆÙ† Ø¥Ø²Ø¹Ø§Ø¬</span>
    </footer>
  </div>

  <div class="confetti" id="confetti"></div>

  <script>
    // Core state
    const TOTAL_STEPS = 12;
    let state = {
      step: 0,
      correct: 0,
      attempted: 0,
      handwritingNotes: 0,
      answers: [] // {num, q, user, correct, ok}
    };

    // Step metadata
    const stepMeta = [
      { title: "Ø§Ù„ØªÙ‡ÙŠØ¦Ø©", desc: "Ø§Ø¶ØºØ· 'Ø´Ø±Ø­ Ù‚ØµÙŠØ±' Ù„Ø®Ø·ÙˆØ§Øª Ø³Ø±ÙŠØ¹Ø©ØŒ Ø«Ù… 'Ø§Ù„ØªØ§Ù„ÙŠ' Ù„Ù„Ø¨Ø¯Ø¡." },
      { title: "Ø§Ù„Ù…Ø¹Ø§Ù†ÙŠ", desc: "Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„ØµØ­ÙŠØ­." },
      { title: "Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„ÙØ±Ø§Øº", desc: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù†Ø³Ø¨." },
      { title: "Ù…Ø¹Ø±ÙØ© Ø¹Ø§Ù…Ø©", desc: "Ø³Ø¤Ø§Ù„ Ø³Ù‡Ù„ØŒ Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©." },
      { title: "Ø§Ù„ÙƒØªØ§Ø¨Ø© (Ù¡)", desc: "Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ ÙƒÙ…Ø§ Ù‡ÙˆØŒ Ø¨Ù„Ø§ Ø£ÙŠ Ø§Ø®ØªÙ„Ø§Ù." },          // step 4
      { title: "Ù…ØµØ·Ù„Ø­Ø§Øª ØªÙ‚Ù†ÙŠØ©", desc: "Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¹Ù†Ù‰ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ù…ØµØ·Ù„Ø­." },
      { title: "Ø§Ù„ÙƒØªØ§Ø¨Ø© (Ù¢)", desc: "Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ ÙƒÙ…Ø§ Ù‡ÙˆØŒ Ø¨Ø¯Ù‚Ø© ØªØ§Ù…Ø©." },              // step 6
      { title: "Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©", desc: "Ø§ÙƒØªØ¨ Ø¨Ø§Ù„Ù…Ø§ÙˆØ³/Ø§Ù„Ù„Ù…Ø³. Ø³Ù†Ø³Ø¬Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© ÙÙ‚Ø·." },
      { title: "Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø³ÙŠØ·Ø©", desc: "Ø§Ø®ØªØ± Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„Ù„ÙˆØ¶ÙˆØ­ ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©." },
      { title: "ØµØ­/Ø®Ø·Ø£", desc: "Ø§Ø®ØªØ± Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ø®Ø§Ø·Ø¦Ø©." },
      { title: "Ø§Ù„ÙƒØªØ§Ø¨Ø© (Ù£)", desc: "Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ ÙƒÙ…Ø§ Ù‡Ùˆ Ù…Ø¹ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ±Ù‚ÙŠÙ…." },       // step 10
      { title: "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©", desc: "Ø´Ø§Ù‡Ø¯ Ù†ØªÙŠØ¬ØªÙƒ Ø¨ØªÙØ§ØµÙŠÙ„ ÙˆØ±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ©." }
    ];

    // Question pools
    const pools = {
      meanings: [
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'compile'ØŸ", options: ["ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙƒÙˆØ¯ Ø¥Ù„Ù‰ Ù…Ù„Ù ØªÙ†ÙÙŠØ°ÙŠ", "Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©", "Ù†Ø³Ø® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹", "Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬"], a: 0 },
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'debug'ØŸ", options: ["Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØªØªØ¨Ø¹Ù‡Ø§", "ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª", "ÙƒØªØ§Ø¨Ø© Ù…Ø³ØªÙ†Ø¯Ø§Øª", "ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©"], a: 0 },
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'plugin'ØŸ", options: ["Ø¥Ø¶Ø§ÙØ© ØªÙÙˆØ³Ø¹ Ù‚Ø¯Ø±Ø§Øª Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬", "Ù…Ù„Ù Ù…Ø´Ø±ÙˆØ¹", "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯", "Ø­Ø²Ù…Ø© Ø®Ø·ÙˆØ·"], a: 0 }
      ],
      blank: [
        { q: "Ø£ÙƒÙ…Ù„: Ù„ÙØªØ­ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ PyCharm Ù†Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ ____ Ø«Ù… Settings.", options: ["File", "Run", "VCS", "Tools"], a: 0 },
        { q: "Ø£ÙƒÙ…Ù„: Ù„ØªØ´ØºÙŠÙ„ Ù…Ù„Ù Python Ù†Ø¶ØºØ· ____.", options: ["Shift+F10", "Ctrl+C", "Alt+Tab", "F1"], a: 0 },
        { q: "Ø£ÙƒÙ…Ù„: Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ© Ù…ØªØºÙŠØ± Ø¨Ø³Ø±Ø¹Ø© Ù†Ø³ØªØ®Ø¯Ù… ____.", options: ["Shift+F6", "Ctrl+Alt+Delete", "Ctrl+Shift+N", "Alt+F4"], a: 0 }
      ],
      general: [
        { q: "Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø±ÙˆÙ ÙÙŠ ÙƒÙ„Ù…Ø© 'Python' Ù‡Ùˆ:", options: ["6", "5", "7", "4"], a: 0 },
        { q: "Ø£ÙˆÙ„ Ø§Ù…ØªØ¯Ø§Ø¯ Ù„Ù…Ù„ÙØ§Øª Ø¨Ø§ÙŠØ«ÙˆÙ† Ù‡Ùˆ:", options: [".py", ".txt", ".json", ".exe"], a: 0 },
        { q: "Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙŠ ØªØ·Ø¨Ø¹ Ø§Ù„Ù†Øµ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©:", options: ["print()", "echo()", "log()", "out()"], a: 0 }
      ],
      techTerms: [
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'virtual environment'ØŸ", options: ["Ø¨ÙŠØ¦Ø© Ù…Ø¹Ø²ÙˆÙ„Ø© Ù„Ø­Ø²Ù… Ø¨Ø§ÙŠØ«ÙˆÙ†", "Ù…Ø´Ø±ÙˆØ¹ ÙˆÙŠØ¨", "Ù…Ù„Ù Ù…Ø¤Ù‚Øª", "Ù…Ø­Ø±Ø± Ù†ØµÙˆØµ"], a: 0 },
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'interpreter'ØŸ", options: ["Ù…ÙÙ†ÙÙ‘Ø° ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¨Ø§ÙŠØ«ÙˆÙ†", "Ù…ÙƒØªØ¨Ø© ØµÙˆØ±", "Ø£Ø¯Ø§Ø© Ù‚Øµ", "Ù…Ù„Ù Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª"], a: 0 },
        { q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ 'commit' ÙÙŠ VCSØŸ", options: ["Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ù…Ø¹ Ø±Ø³Ø§Ù„Ø©", "Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØ§Øª", "Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„", "Ù†Ù‚Ù„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"], a: 0 }
      ],
      compare: [
        { q: "Ù„Ø§Ø³Ù… Ù…ØªØºÙŠØ± ÙˆØ§Ø¶Ø­ Ø£ÙŠÙ‡Ù…Ø§ Ø£ÙØ¶Ù„ØŸ", options: ["total_score", "ts", "t", "var1"], a: 0 },
        { q: "Ø§Ø®ØªÙŠØ§Ø± Ø¨ÙŠØ¦Ø© Ø¹Ù…Ù„ Ù„Ù…Ø´Ø±ÙˆØ¹ ØµØºÙŠØ±:", options: ["venv Ø¨Ø³ÙŠØ·", "Ù„Ø§ Ø´ÙŠØ¡", "Ø¨ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ø¨Ø§Ø´Ø±Ø©", "Ù…Ù„Ù Ù†ØµÙŠ"], a: 0 },
        { q: "Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø²Ù… ÙÙŠ Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¹Ø²ÙˆÙ„:", options: ["pip Ø¯Ø§Ø®Ù„ venv", "Ù†Ø³Ø® ÙŠØ¯ÙˆÙŠ", "zip Ù„Ù„Ø­Ø²Ù…", "Ø£ÙˆØ§Ù…Ø± Ù†Ø¸Ø§Ù…"], a: 0 }
      ],
      tf: [
        { q: "Ø¨Ø§ÙŠØ«ÙˆÙ† Ù„ØºØ© Ù…ÙÙØ³Ù‘ÙØ±Ø© ÙˆÙ„ÙŠØ³Øª Ù…ÙØªØ±Ø¬Ù…Ø©.", options: ["ØµØ­", "Ø®Ø·Ø£"], a: 0 },
        { q: "PyCharm Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø¥Ø·Ù„Ø§Ù‚Ù‹Ø§.", options: ["Ø®Ø·Ø£", "ØµØ­"], a: 0 },
        { q: "ÙŠÙˆÙØ± PyCharm ØªÙ„ÙˆÙŠÙ† Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ù…Ù„Ø© (Syntax Highlighting).", options: ["ØµØ­", "Ø®Ø·Ø£"], a: 0 }
      ],
      typing1: [
        "print('Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙŠØ§ ÙˆÙ„ÙŠØ¯')",
        "name = 'Waleed'\nprint(name)",
        "for i in range(3):\n    print('PyCharm')"
      ],
      typing2: [
        "x = 5\nif x > 3:\n    print('ÙƒØ¨ÙŠØ±')",
        "def add(a, b):\n    return a + b",
        "msg = 'Ø§Ø®ØªØ¨Ø§Ø±'\nprint(msg.upper())"
      ],
      typing3: [
        "nums = [1, 2, 3]\nfor n in nums:\n    print(n)",
        "text = 'waleed'\nprint(text.capitalize())",
        "print('ØªÙ…')"
      ],
      handwritingHints: [
        "Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© 'Ø¨Ø§ÙŠØ«ÙˆÙ†' Ø¨Ø®Ø· ÙˆØ§Ø¶Ø­.",
        "Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø¨Ø®Ø· Ù…Ù‚Ø±ÙˆØ¡.",
        "Ø§Ø±Ø³Ù… Ù‚ÙˆØ³ÙŠÙ† Ù‡ÙƒØ°Ø§: ()."
      ],
      survey: [
        { q: "Ù‚ÙŠÙ‘Ù… ØªØ¬Ø±Ø¨ØªÙƒ:", options: ["Ù…Ù…ØªØ§Ø²", "Ø¬ÙŠØ¯", "Ù…Ù‚Ø¨ÙˆÙ„", "Ø¨Ø­Ø§Ø¬Ø© Ù„ØªØ­Ø³ÙŠÙ†"], a: 0 }
      ]
    };

    // Utility
    function pick(pool) { return pool[Math.floor(Math.random() * pool.length)]; }

    // Render step dots
    function renderDots() {
      const stepsEl = document.getElementById("steps");
      stepsEl.innerHTML = "";
      for (let i = 0; i < TOTAL_STEPS; i++) {
        const dot = document.createElement("div");
        dot.className = "step-dot" + (i === state.step ? " active" : i < state.step ? " done" : "");
        stepsEl.appendChild(dot);
      }
    }

    // Step renderer
    function renderStep() {
      renderDots();
      const titleEl = document.getElementById("stepTitle");
      const descEl = document.getElementById("stepDesc");
      const qBox = document.getElementById("questionBox");
      const resBox = document.getElementById("resultBox");
      resBox.style.display = "none";
      qBox.innerHTML = "";

      const meta = stepMeta[state.step];
      titleEl.textContent = meta.title || "";
      descEl.textContent = meta.desc || "";

      switch (state.step) {
        case 0: {
          qBox.innerHTML = `<div class="muted">Ø§Ø¨Ø¯Ø£ Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ø¬Ø§Ù‡Ø²Ù‹Ø§. Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØªØªØºÙŠØ± ÙÙŠ ÙƒÙ„ ØªØ´ØºÙŠÙ„.</div>`;
          break;
        }
        case 1: { renderMC(pick(pools.meanings), qBox); break; }
        case 2: { renderMC(pick(pools.blank), qBox); break; }
        case 3: { renderMC(pick(pools.general), qBox); break; }
        case 4: { renderTyping(pick(pools.typing1), qBox, { exact: true }); break; }
        case 5: { renderMC(pick(pools.techTerms), qBox); break; }
        case 6: { renderTyping(pick(pools.typing2), qBox, { exact: true }); break; }
        case 7: { renderHandwriting(qBox); break; }
        case 8: { renderMC(pick(pools.compare), qBox); break; }
        case 9: { renderMC(pick(pools.tf), qBox); break; }
        case 10:{ renderTyping(pick(pools.typing3), qBox, { exact: true }); break; }
        case 11:{ renderSurvey(qBox); break; }
      }
    }

    function renderMC(item, host) {
      const qNum = state.attempted + 1;
      const q = document.createElement("div");
      q.innerHTML = `<div><strong>Ø§Ù„Ø³Ø¤Ø§Ù„:</strong> ${item.q}</div>`;
      host.appendChild(q);

      const opts = document.createElement("div");
      opts.className = "options";
      item.options.forEach((opt, idx) => {
        const btn = document.createElement("button");
        btn.className = "btn";
        btn.textContent = opt;
        btn.onclick = () => {
          state.attempted++;
          const ok = idx === item.a;
          if (ok) { state.correct++; btn.className = "btn btn-primary"; }
          else { btn.className = "btn btn-danger"; }
          state.answers.push({ num: qNum, q: item.q, user: opt, correct: item.options[item.a], ok });
          [...opts.children].forEach(b => b.disabled = true);
        };
        opts.appendChild(btn);
      });
      host.appendChild(opts);
    }

    function renderTyping(targetText, host, { exact = true } = {}) {
      const qNum = state.attempted + 1;

      const tip = document.createElement("div");
      tip.className = "muted";
      tip.textContent = "Ø§Ù†Ø³Ø® Ø§Ù„Ù†Øµ Ø§Ù„ØªØ§Ù„ÙŠ ÙƒÙ…Ø§ Ù‡Ùˆ (ÙŠØ´Ù…Ù„ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø£Ø³Ø·Ø±):";
      host.appendChild(tip);

      const pre = document.createElement("pre");
      pre.style.background = "#0f1a2b";
      pre.style.border = "1px solid rgba(255,255,255,0.12)";
      pre.style.borderRadius = "10px";
      pre.style.padding = "10px";
      pre.style.whiteSpace = "pre-wrap";
      pre.style.direction = "ltr";
      pre.style.textAlign = "left";
      pre.textContent = targetText;
      host.appendChild(pre);

      const ta = document.createElement("textarea");
      ta.className = "input";
      ta.placeholder = "Ø§ÙƒØªØ¨ Ù‡Ù†Ø§ Ø¨Ø§Ù„Ø¶Ø¨Ø· Ù†ÙØ³ Ø§Ù„Ù†Øµ...";
      ta.style.height = "160px";
      ta.style.direction = "ltr";
      ta.style.textAlign = "left";
      host.appendChild(ta);

      const check = document.createElement("button");
      check.className = "btn btn-secondary";
      check.textContent = "ØªØ­Ù‚Ù‚";
      check.onclick = () => {
        state.attempted++;
        const ok = exact ? (ta.value === targetText) : normalize(ta.value) === normalize(targetText);
        if (ok) state.correct++;
        state.answers.push({ num: qNum, q: "Ù…Ù‡Ù…Ø© ÙƒØªØ§Ø¨Ø©", user: ok ? "Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©" : "ØºÙŠØ± Ù…Ø·Ø§Ø¨Ù‚Ø©", correct: "Ù…Ø·Ø§Ø¨Ù‚Ø© ØªØ§Ù…Ø©", ok });
        showTypingResult(ok);
      };
      host.appendChild(check);
    }

    function normalize(s) { return s.replace(/\s+/g, " ").trim(); }

    function showTypingResult(ok) {
      const box = document.getElementById("resultBox");
      box.style.display = "block";
      box.innerHTML = ok
        ? "<strong>Ù†ØªÙŠØ¬Ø©:</strong> ØµØ­ÙŠØ­! ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…."
        : "<strong>Ù†ØªÙŠØ¬Ø©:</strong> ÙŠÙˆØ¬Ø¯ Ø§Ø®ØªÙ„Ø§Ù Ø¨Ø³ÙŠØ·. Ø§Ù†ØªØ¨Ù‡ Ù„Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ø£Ø³Ø·Ø±.";
    }

    function renderHandwriting(host) {
      const qNum = state.attempted + 1;

      const hint = document.createElement("div");
      hint.className = "muted";
      hint.textContent = pick(pools.handwritingHints);
      host.appendChild(hint);

      const wrap = document.createElement("div");
      wrap.className = "handwrite";
      const canvas = document.createElement("canvas");
      wrap.appendChild(canvas);
      host.appendChild(wrap);

      let drawing = false;
      let ctx;
      function resize() {
        canvas.width = wrap.clientWidth;
        canvas.height = wrap.clientHeight;
        ctx = canvas.getContext("2d");
        ctx.lineCap = "round";
        ctx.lineJoin = "round";
        ctx.strokeStyle = "#4db3ff";
        ctx.lineWidth = 3;
      }
      resize();
      window.addEventListener("resize", resize);

      canvas.addEventListener("mousedown", (e) => { drawing = true; draw(e); });
      canvas.addEventListener("mousemove", draw);
      window.addEventListener("mouseup", () => { drawing = false; ctx && ctx.beginPath(); });

      canvas.addEventListener("touchstart", (e) => { drawing = true; draw(e.touches[0]); }, { passive: true });
      canvas.addEventListener("touchmove", (e) => draw(e.touches[0]), { passive: true });
      window.addEventListener("touchend", () => { drawing = false; ctx && ctx.beginPath(); }, { passive: true });

      function draw(e) {
        if (!drawing) return;
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX - rect.left);
        const y = (e.clientY - rect.top);
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(x, y);
      }

      const note = document.createElement("div");
      note.className = "muted";
      note.style.marginTop = "10px";
      note.textContent = "Ù…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø§ ØªÙØ¹Ø±Ø¶ Ù†ØªÙŠØ¬Ø© Ù‡Ù†Ø§ØŒ Ø³Ù†Ø³Ø¬Ù„ ÙÙ‚Ø· Ø¥Ù† ÙƒØ§Ù†Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ØµØ¹Ø¨Ø©.";
      host.appendChild(note);

      const btn = document.createElement("button");
      btn.className = "btn btn-secondary";
      btn.textContent = "Ø¥ØªÙ…Ø§Ù… Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙŠØ¯ÙˆÙŠØ©";
      btn.onclick = () => {
        state.attempted++;
        state.handwritingNotes++;
        state.answers.push({ num: qNum, q: "ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠØ©", user: "ØªÙ…Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©", correct: "â€”", ok: true });
        const res = document.getElementById("resultBox");
        res.style.display = "block";
        res.innerHTML = "<strong>ØªÙ…:</strong> Ø³ÙØ¬Ù„Ù‘Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©. Ø¥Ù† ÙƒØ§Ù†Øª ØºÙŠØ± Ù…Ù‚Ø±ÙˆØ¡Ø© Ø³Ù†Ù†Ø¨Ù‡Ùƒ Ù„Ø§Ø­Ù‚Ù‹Ø§.";
      };
      host.appendChild(btn);
    }

    function renderSurvey(host) {
      const item = pools.survey[0];
      const q = document.createElement("div");
      q.innerHTML = `<div><strong>Ø§Ù„Ø³Ø¤Ø§Ù„:</strong> ${item.q}</div>`;
      host.appendChild(q);

      const opts = document.createElement("div");
      opts.className = "options";
      item.options.forEach((opt) => {
        const btn = document.createElement("button");
        btn.className = "btn";
        btn.textContent = opt;
        btn.onclick = () => {
          [...opts.children].forEach(b => b.disabled = true);
          btn.className = "btn btn-primary";
          showFinal();
        };
        opts.appendChild(btn);
      });
      host.appendChild(opts);
    }

    // Advanced final results (gauge, counters, confetti, table)
    function showFinal() {
      const res = document.getElementById("resultBox");
      res.style.display = "block";

      // Scoring: scale to 20, 10, percent, GPA
      const attempted = Math.max(1, state.attempted);
      const score20 = Math.round((state.correct / attempted) * 20);
      const score10 = (score20 / 2).toFixed(1);
      const percent = Math.round((score20 / 20) * 100);
      const gpa = ((score20 / 20) * 4).toFixed(2);
      const pass = percent >= 60;
      const badge = score20 >= 18 ? "ğŸ† Ù…Ø¨Ø¯Ø¹ ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©" : score20 >= 15 ? "â­ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹" : score20 >= 12 ? "ğŸ‘ Ø¬ÙŠØ¯" : "";

      // Build results UI
      res.innerHTML = `
        <section id="finalResults" style="padding:20px 12px;">
          <h3 style="color:#30d158; font-size:24px; text-shadow:0 0 10px #30d158; margin:0 0 10px;">Ù†ØªÙŠØ¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h3>

          <!-- Gauge -->
          <div id="gpaGauge" style="margin:20px auto; width:300px; height:170px; position:relative;">
            <canvas id="gaugeCanvas" width="300" height="170"></canvas>
            <div id="gpaLabel" style="position:absolute; bottom:8px; left:50%; transform:translateX(-50%); font-size:16px; font-weight:bold;">GPA: ${gpa} Ù…Ù† 4</div>
          </div>

          <!-- Stats with animated counters -->
          <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; max-width:640px; margin:0 auto;">
            <div style="background:rgba(255,255,255,0.05); padding:12px; border-radius:10px;">
              <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div>
              <div id="score20" style="font-size:20px; font-weight:bold; color:#4db3ff;">${score20} Ù…Ù† 20</div>
            </div>
            <div style="background:rgba(255,255,255,0.05); padding:12px; border-radius:10px;">
              <div>Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ù…Ù† 10</div>
              <div id="score10" style="font-size:20px; font-weight:bold; color:#4db3ff;">${score10} Ù…Ù† 10</div>
            </div>
            <div style="background:rgba(255,255,255,0.05); padding:12px; border-radius:10px;">
              <div>Ø§Ù„Ù†Ø³Ø¨Ø©</div>
              <div id="percent" style="font-size:20px; font-weight:bold; color:#4db3ff;">${percent}%</div>
            </div>
            <div style="background:rgba(255,255,255,0.05); padding:12px; border-radius:10px;">
              <div>Ø§Ù„Ø­Ø§Ù„Ø©</div>
              <div style="font-size:20px; font-weight:bold; color:${pass ? '#30d158' : '#ff6b6b'};">${pass ? 'Ù†Ø§Ø¬Ø­ âœ…' : 'Ø±Ø§Ø³Ø¨ âŒ'}</div>
            </div>
          </div>

          ${badge ? `<p style="margin-top:12px; font-size:18px; color:#4db3ff; animation:fadeIn 1s ease;">${badge}</p>` : ""}

          <!-- Review table -->
          <div id="review" style="margin-top:18px; overflow-x:auto;">
            <table style="width:100%; border-collapse:collapse; font-size:14px;">
              <thead>
                <tr style="background:#13233d;">
                  <th style="padding:8px; border:1px solid #2a3a56;">#</th>
                  <th style="padding:8px; border:1px solid #2a3a56;">Ø§Ù„Ø³Ø¤Ø§Ù„</th>
                  <th style="padding:8px; border:1px solid #2a3a56;">Ø¥Ø¬Ø§Ø¨ØªÙƒ</th>
                  <th style="padding:8px; border:1px solid #2a3a56;">Ø§Ù„ØµØ­ÙŠØ­</th>
                  <th style="padding:8px; border:1px solid #2a3a56;">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                </tr>
              </thead>
              <tbody id="reviewBody"></tbody>
            </table>
          </div>

          <!-- Actions -->
          <div class="controls" style="justify-content:center; margin-top:16px;">
            <button class="btn btn-secondary" onclick="restart()">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
            <button class="btn btn-primary" onclick="document.getElementById('review').scrollIntoView({behavior:'smooth'})">ğŸ“‹ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
          </div>
        </section>
      `;

      // Fill review table
      const tbody = document.getElementById("reviewBody");
      tbody.innerHTML = state.answers.map(a => `
        <tr>
          <td style="padding:6px; border:1px solid #2a3a56;">${a.num}</td>
          <td style="padding:6px; border:1px solid #2a3a56;">${a.q}</td>
          <td style="padding:6px; border:1px solid #2a3a56;">${a.user}</td>
          <td style="padding:6px; border:1px solid #2a3a56;">${a.correct}</td>
          <td style="padding:6px; border:1px solid #2a3a56; color:${a.ok ? '#30d158' : '#ff6b6b'};">${a.ok ? 'âœ…' : 'âŒ'}</td>
        </tr>
      `).join("");

      // Gauge draw + animate needle
      drawGauge(percent);

      // Confetti on pass
      if (pass) launchConfetti(80);
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function restart() {
      state = { step: 0, correct: 0, attempted: 0, handwritingNotes: 0, answers: [] };
      renderStep();
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // Tutorial / Navigation
    document.getElementById("btnTutorial").addEventListener("click", () => {
      const res = document.getElementById("resultBox");
      res.style.display = "block";
      res.innerHTML = `
        <div><strong>Ø§Ù„Ø®Ø·ÙˆØ§Øª:</strong></div>
        <ul style="margin:8px 0 0 16px; line-height:1.7;">
          <li>Ø¹Ø¯Ø¯ Ø§Ù„Ø®Ø·ÙˆØ§Øª: 12. Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ØªØªØºÙŠØ± ÙÙŠ ÙƒÙ„ ØªØ´ØºÙŠÙ„.</li>
          <li>Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ§Øª 4 Ùˆ6 Ùˆ10 (Ø§Ø«Ù†ØªØ§Ù† ÙƒØªØ§Ø¨Ø© Ø¯Ù‚ÙŠÙ‚Ø©ØŒ ÙˆÙˆØ§Ø­Ø¯Ø© ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ© 7).</li>
          <li>ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø³ØªØ±Ù‰ Ù†ØªÙŠØ¬ØªÙƒ Ù…Ø¹ Ø±Ø³ÙˆÙ… Ù…ØªØ­Ø±ÙƒØ© ÙˆØ¬Ø¯ÙˆÙ„ Ù…Ø±Ø§Ø¬Ø¹Ø©.</li>
        </ul>
      `;
    });
    document.getElementById("btnBack").addEventListener("click", () => {
      if (state.step > 0) { state.step--; renderStep(); }
    });
    document.getElementById("btnNext").addEventListener("click", () => {
      if (state.step < TOTAL_STEPS - 1) { state.step++; renderStep(); }
    });

    // Floating PyCharm code snippets generator (faster)
    const pyBits = [
      "print('Hello')", "for i in range(3): print(i)", "name = 'Waleed'",
      "def add(a,b): return a+b", "x = 5 if True else 3", "nums = [1,2,3]",
      "with open('file.txt') as f:", "import sys", "if x > 3: print('ok')",
      "msg = 'PyCharm'", "len('abc')", "sum([1,2,3])", "x = None", "str(123)", "list(range(5))",
      "from math import sqrt", "print('âœ”')", "for n in [1,2,3]: print(n)"
    ];

    function spawnFloatBits() {
      const layer = document.getElementById("floatLayer");
      const count = 40;
      for (let i = 0; i < count; i++) {
        const el = document.createElement("div");
        el.className = "code-bit";
        el.textContent = pyBits[Math.floor(Math.random() * pyBits.length)];
        const xStart = Math.random() * window.innerWidth;
        const yStart = Math.random() * window.innerHeight;
        const xEnd = (Math.random() * window.innerWidth) - (window.innerWidth * 0.35);
        const yEnd = (Math.random() * window.innerHeight) - (window.innerHeight * 0.35);
        const rot = (Math.random() * 60 - 30) + "deg";
        const dur = 10 + Math.random() * 10; // faster drift
        el.style.setProperty("--x-start", xStart + "px");
        el.style.setProperty("--y-start", yStart + "px");
        el.style.setProperty("--x-end", xEnd + "px");
        el.style.setProperty("--y-end", yEnd + "px");
        el.style.setProperty("--rot", rot);
        el.style.animationDuration = dur + "s";
        el.style.animationDelay = (-Math.random() * dur) + "s";
        layer.appendChild(el);
      }
    }

    // Moving lines generator
    function spawnLines() {
      const lines = document.getElementById("lines");
      const count = Math.floor(window.innerWidth / 40);
      lines.innerHTML = "";
      for (let i = 0; i < count; i++) {
        const line = document.createElement("div");
        line.className = "line";
        const left = i * 40 + (Math.random() * 20);
        line.style.left = left + "px";
        line.style.animationDelay = (-Math.random() * 6) + "s";
        line.style.opacity = (0.04 + Math.random() * 0.06);
        lines.appendChild(line);
      }
    }
    window.addEventListener("resize", spawnLines);

    // Gauge drawing (segmented arc + needle)
    function drawGauge(percent) {
      const canvas = document.getElementById("gaugeCanvas");
      if (!canvas) return;
      const ctx = canvas.getContext("2d");
      const w = canvas.width, h = canvas.height;
      ctx.clearRect(0, 0, w, h);

      const cx = w / 2, cy = h - 10, r = Math.min(w, h * 2) / 2 - 10;
      const start = Math.PI;      // 180Â°
      const end = 2 * Math.PI;    // 360Â°

      // Segments: Ø¶Ø¹ÙŠÙØŒ Ù…Ù‚Ø¨ÙˆÙ„ØŒ Ø¬ÙŠØ¯ØŒ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹ØŒ Ù…Ù…ØªØ§Ø²
      const segments = [
        { color: "#ff4d4d", label: "Ø¶Ø¹ÙŠÙ" },
        { color: "#ff9f43", label: "Ù…Ù‚Ø¨ÙˆÙ„" },
        { color: "#ffd93d", label: "Ø¬ÙŠØ¯" },
        { color: "#9ae66e", label: "Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹" },
        { color: "#30d158", label: "Ù…Ù…ØªØ§Ø²" }
      ];

      // Draw segments
      const segAngle = (end - start) / segments.length;
      ctx.lineWidth = 16;
      for (let i = 0; i < segments.length; i++) {
        ctx.beginPath();
        ctx.strokeStyle = segments[i].color;
        ctx.arc(cx, cy, r, start + i * segAngle, start + (i + 1) * segAngle);
        ctx.stroke();
      }

      // Needle animation
      const target = start + (percent / 100) * (end - start);
      let angle = start;
      const needle = () => {
        ctx.clearRect(0, 0, w, h);
        // redraw segments
        ctx.lineWidth = 16;
        for (let i = 0; i < segments.length; i++) {
          ctx.beginPath();
          ctx.strokeStyle = segments[i].color;
          ctx.arc(cx, cy, r, start + i * segAngle, start + (i + 1) * segAngle);
          ctx.stroke();
        }
        // center dot
        ctx.beginPath();
        ctx.fillStyle = "#eaf2ff";
        ctx.arc(cx, cy, 5, 0, 2 * Math.PI);
        ctx.fill();
        // needle
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(angle - Math.PI / 2);
        ctx.strokeStyle = "#eaf2ff";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.lineTo(r - 6, 0);
        ctx.stroke();
        ctx.restore();

        if (angle < target) {
          angle += Math.max(0.02, (target - angle) * 0.08);
          requestAnimationFrame(needle);
        }
      };
      needle();
    }

    // Confetti
    function launchConfetti(n = 60) {
      const confetti = document.getElementById("confetti");
      confetti.innerHTML = "";
      const colors = ["#30d158", "#4db3ff", "#ffd93d", "#ff9f43", "#ff6b6b"];
      for (let i = 0; i < n; i++) {
        const piece = document.createElement("div");
        piece.className = "confetti-piece";
        piece.style.left = Math.random() * 100 + "%";
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.transform = `translateY(-20px) rotate(${Math.random() * 360}deg)`;
        piece.style.animationDuration = (2.4 + Math.random() * 1.6) + "s";
        piece.style.animationDelay = (-Math.random() * 2) + "s";
        confetti.appendChild(piece);
      }
      // auto clear
      setTimeout(() => confetti.innerHTML = "", 4000);
    }

    // Init
    spawnLines();
    spawnFloatBits();
    renderStep();
  </script>
</body>
</html>
